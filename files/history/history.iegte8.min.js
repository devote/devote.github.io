/*!
 * History API JavaScript Library v4.1.7
 *
 * Support: IE8+, FF3+, Opera 9+, Safari, Chrome and other
 *
 * Copyright 2011-2014, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 2014-05-19 16:57
 */
(function(I){"function"===typeof define&&define.amd?define("object"!==typeof document||"loading"!==document.readyState?[]:"html5-history-api",I):I()})(function(){var i=!0,j=null,n=!1;function J(a,b){var c=d.history!==q;c&&(d.history=q);a.apply(q,b);c&&(d.history=g)}function D(){}function l(a,b,c){if(a!=j&&""!==a&&!b)var b=l(),c=b.d,h=b.h,a=""+a,a=/^(?:[\w0-9]+\:)?\/\//.test(a)?0===a.indexOf("/")?h+a:a:h+"//"+b.g+(0===a.indexOf("/")?a:0===a.indexOf("?")?c+a:0===a.indexOf("#")?c+b.e+a:c.replace(/[^\/]+$/g,"")+a);else if(a=b?a:e.href,!p||c)a=a.replace(/^[^#]*/,"")||"#",a=e.protocol.replace(/:.*$|$/,":")+"//"+e.host+k.basepath+a.replace(RegExp("^#[/]?(?:"+k.type+")?"),
"");K.href=a;var a=/(?:([\w0-9]+:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/.exec(K.href),b=a[2]+(a[3]?":"+a[3]:""),c=a[4]||"/",h=a[5]||"",d="#"===a[6]?"":a[6]||"",f=c+h+d,g=c.replace(RegExp("^"+k.basepath,"i"),k.type)+h;return{b:a[1]+"//"+b+f,h:a[1],g:b,i:a[2],k:a[3]||"",d:c,e:h,a:d,c:f,j:g,f:g+d}}function X(){var a;try{a=d.sessionStorage,a.setItem(x+"t","1"),a.removeItem(x+"t")}catch(b){a={getItem:function(a){a=f.cookie.split(a+"=");return 1<a.length&&
a.pop().split(";").shift()||"null"},setItem:function(a){var b={};if(b[e.href]=g.state)f.cookie=a+"="+y.stringify(b)}}}try{m=y.parse(a.getItem(x))||{}}catch(c){m={}}o(r+"unload",function(){a.setItem(x,y.stringify(m))},n)}function z(a,b,c,h){var c=c||{set:D},e=!c.set,f=!c.get,g={configurable:i,set:function(){e=1},get:function(){f=1}};try{u(a,b,g),a[b]=a[b],u(a,b,c)}catch(k){}if(!e||!f)if(a.__defineGetter__&&(a.__defineGetter__(b,g.get),a.__defineSetter__(b,g.set),a[b]=a[b],c.get&&a.__defineGetter__(b,
c.get),c.set&&a.__defineSetter__(b,c.set)),(!e||!f)&&a===d){try{var l=a[b];a[b]=j}catch(p){}if("execScript"in d)d.execScript("Public "+b,"VBScript"),d.execScript("var "+b+";","JavaScript");else try{u(a,b,{value:D})}catch(q){}a[b]=l}else if(!e||!f)try{try{var m=E.create(a);u(E.getPrototypeOf(m)===a?m:a,b,c);for(var o in a)"function"===typeof a[o]&&(m[o]=a[o].bind(a));try{h.call(m,m,a)}catch(r){}a=m}catch(s){u(a.constructor.prototype,b,c)}}catch(t){return n}return a}function Y(a,b,c){c=c||{};a=a===
L?e:a;c.set=c.set||function(c){a[b]=c};c.get=c.get||function(){return a[b]};return c}function Z(a,b,c){a in s?s[a].push(b):3<arguments.length?o(a,b,c,arguments[3]):o(a,b,c)}function $(a,b,c){var d=s[a];if(d)for(a=d.length;--a;){if(d[a]===b){d.splice(a,1);break}}else M(a,b,c)}function A(a,b){var c=(""+("string"===typeof a?a:a.type)).replace(/^on/,""),h=s[c];if(h){b="string"===typeof a?b:a;if(b.target==j)for(var e=["target","currentTarget","srcElement","type"];a=e.pop();)b=z(b,a,{get:"type"===a?function(){return c}:
function(){return d}});(("popstate"===c?d.onpopstate:d.onhashchange)||D).call(d,b);for(var e=0,f=h.length;e<f;e++)h[e].call(d,b);return i}return aa(a,b)}function N(){var a=f.createEvent?f.createEvent("Event"):f.createEventObject();a.initEvent?a.initEvent("popstate",n,n):a.type="popstate";a.state=g.state;A(a)}function v(a,b,c,d){p||(b=l(b),b.c!==l().c&&(w=d,c?e.replace("#"+b.f):e.hash=b.f));!B&&a&&(m[e.href]=a);C=n}function O(a){var b=w;w=e.href;if(b){P!==e.href&&N();var a=a||d.event,b=l(w,i),c=l();
a.oldURL||(a.oldURL=b.b,a.newURL=c.b);b.a!==c.a&&A(a)}}function Q(a){setTimeout(function(){o("popstate",function(a){P=e.href;B||(a=z(a,"state",{get:function(){return g.state}}));A(a)},n)},0);!p&&(a!==i&&g.location)&&(R(g.location.hash),C&&(C=n,N()))}function ba(a){var a=a||d.event,b;a:{for(b=a.target||a.srcElement;b;){if("A"===b.nodeName)break a;b=b.parentNode}b=void 0}var c="defaultPrevented"in a?a.defaultPrevented:a.returnValue===n;b&&("A"===b.nodeName&&!c)&&(c=l(),b=l(b.getAttribute("href",2)),
c.b.split("#").shift()===b.b.split("#").shift()&&b.a&&(c.a!==b.a&&(g.location.hash=b.a),R(b.a),a.preventDefault?a.preventDefault():a.returnValue=n))}function R(a){var b=f.getElementById(a=(a||"").replace(/^#/,""));b&&(b.id===a&&"A"===b.nodeName)&&(a=b.getBoundingClientRect(),d.scrollTo(F.scrollLeft||0,a.top+(F.scrollTop||0)-(F.clientTop||0)))}var d=("object"===typeof window?window:this)||{};if(!d.history||"emulate"in d.history)return d.history;var f=d.document,F=f.documentElement,E=d.Object,y=d.JSON,
e=d.location,q=d.history,g=q,G=q.pushState,S=q.replaceState,p=!!G,B="state"in q,u=E.defineProperty,T=z({},"t")?{}:f.createElement("a"),r="",H=d.addEventListener?"addEventListener":(r="on")&&"attachEvent",U=d.removeEventListener?"removeEventListener":"detachEvent",V=d.dispatchEvent?"dispatchEvent":"fireEvent",o=d[H],M=d[U],aa=d[V],k={basepath:"/",redirect:0,type:"/"},x="__historyAPI__",K=f.createElement("a"),w=e.href,P="",C=n,m={},s={},t=f.title,ca={onhashchange:j,onpopstate:j},W={setup:function(a,
b,c){k.basepath=(""+(a==j?k.basepath:a)).replace(/(?:^|\/)[^\/]*$/,"/");k.type=b==j?k.type:b;k.redirect=c==j?k.redirect:!!c},redirect:function(a,b){g.setup(b,a);b=k.basepath;if(d.top==d.self){var c=l(j,n,i).c,h=e.pathname+e.search;p?(h=h.replace(/([^\/])$/,"$1/"),c!=b&&RegExp("^"+b+"$","i").test(h)&&e.replace(c)):h!=b&&(h=h.replace(/([^\/])\?/,"$1/?"),RegExp("^"+b,"i").test(h)&&e.replace(b+"#"+h.replace(RegExp("^"+b,"i"),k.type)+e.hash))}},pushState:function(a,b,c){var d=f.title;t!=j&&(f.title=t);
G&&J(G,arguments);v(a,c);f.title=d;t=b},replaceState:function(a,b,c){var d=f.title;t!=j&&(f.title=t);delete m[e.href];S&&J(S,arguments);v(a,c,i);f.title=d;t=b},location:{set:function(a){d.location=a},get:function(){return p?e:T}},state:{get:function(){return m[e.href]||j}}},L={assign:function(a){0===(""+a).indexOf("#")?v(j,a):e.assign(a)},reload:function(){e.reload()},replace:function(a){0===(""+a).indexOf("#")?v(j,a,i):e.replace(a)},toString:function(){return this.href},href:{get:function(){return l().b}},
protocol:j,host:j,hostname:j,port:j,pathname:{get:function(){return l().d}},search:{get:function(){return l().e}},hash:{set:function(a){v(j,(""+a).replace(/^(#|)/,"#"),n,w)},get:function(){return l().a}}};if(function(){var a=f.getElementsByTagName("script"),a=(a[a.length-1]||{}).src||"";(-1!==a.indexOf("?")?a.split("?").pop():"").replace(/(\w+)(?:=([^&]*))?/g,function(a,b,c){k[b]=(c||"").replace(/^(0|false)$/,"")});o(r+"hashchange",O,n);var b=[L,T,ca,d,W,g];B&&delete W.state;for(var c=0;c<b.length;c+=
2)for(var e in b[c])if(b[c].hasOwnProperty(e))if("function"===typeof b[c][e])b[c+1][e]=b[c][e];else{a=Y(b[c],e,b[c][e]);if(!z(b[c+1],e,a,function(a,e){if(e===g)d.history=g=b[c+1]=a}))return M(r+"hashchange",O,n),n;b[c+1]===d&&(s[e]=s[e.substr(2)]=[])}g.setup();k.redirect&&g.redirect();!B&&y&&X();if(!p)f[H](r+"click",ba,n);"complete"===f.readyState?Q(i):(!p&&l().c!==k.basepath&&(C=i),o(r+"load",Q,n));return i}())return g.emulate=!p,d[H]=Z,d[U]=$,d[V]=A,g});