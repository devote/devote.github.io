/**
 * boon v1.0.2 - Powerful and flexible generator objects with the possibility of meta-inheritance for JavaScript
 * Copyright 2011-2014 Dmitrii Pakhtinov (spb.piksel@gmail.com)
 * Released under the MIT license
 * Update: 06/19/2014
 */
(function(i,P,y,p,E){function Q(c,d){return function(){throw Error("'"+c+"' property is "+(d?"read":"write")+"-only");}}function U(c){return function(){return c}}function n(c,d,j,f,F){function h(){var a=this instanceof R,b=arguments;if(!a&&!(this instanceof h))return N.call(h,b[0]);var d=J,l=p,m=F.apply({isParent:a,options:f},a?b[0]:b),n=a&&b[3]||p,g=y||n||m,o=a?b[1]:{a:m},k=!a||b[2]===E||z!==E?z:b[2];for(C(O,function(a,e){D.call(m,a)||(m[a]=e)});d--;)"function"!==typeof j[d]&&(j[d]="string"===typeof j[d]?
V(j[d],c):U(j[d])),v.prototype=l=j[d].call(new R,b,o,k,n),0<d&&(o.i=p),g=n=new v,k||(g.parent=l,W&&(g.__proto__=l));if(J||a||y){var r=function(a){return k?a:"function"===typeof a?function(){var e=o.a,c=e.parent;!k&&(e.parent=l);var b=a.apply(this===g||this==i?e:this,arguments);!k&&(e.parent=c);return b}:a};C(m,function(a,e){if(e&&"object"===typeof e&&("set"in e&&(e.set=r(e.set)),"get"in e))e.get=r(e.get);g[a]=r(e)});o.a=a?o.a:g}k||(g.__boon__=h);if(!a&&0!==w){if(!A||B)C(B?g:w,function(a){var e=g[a],
c=a,b=!B?w[a]:e&&"object"===typeof e&&"parent"!==a&&"__proto__"!==a&&(e.set||e.get)?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:A&&"toString"===a?4:0;if(b)if(B&&4!==(w[a]=b)&&K++,1===b?(v.prototype=e,e=new v):(c=a.split(" ").pop(),3!==b&&"function"!==typeof e&&(e=function(a){return function(){return a}}(e))),A)3!==b&&q.push("Public "+(4===b?"Default ":"")+"Property Get ["+c+"]","Call VBCorrectVal("+(e&&(1!==b||e.get)?"[(accessors)].["+a+"]"+(1===b?".get":"")+".call(me,[(accessors)].["+a+"])":
"window.undefined")+",["+c+"])","End Property"),2!==b&&q.push("Public Property Let ["+c+"](val)",b=(4===b?"Set [(accessors)].["+a+"]=val":e&&(1!==b||e.set)?"Call [(accessors)].["+a+"]"+(1===b?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+c+"](val)",b);else{var d=k?E:Q(c,1),f=k?E:Q(c,0);if(1===b?e.set:3===b&&e)d=function(a){(b===1?e.set:e).call(this,a,e)};if(1===b?e.get:2===b&&e)f=function(){return(b===1?e.get:e).call(this,e)};D.call(g,a)&&delete g[a];
G?(a=s.getOwnPropertyDescriptor(g,c),G(g,c,{enumerable:H?0:1,configurable:1,set:2===b&&a&&a.set||d,get:3===b&&a&&a.get||f})):((d=2===b&&g.__lookupSetter__(c)||d)&&g.__defineSetter__(c,d),(f=3===b&&g.__lookupGetter__(c)||f)&&g.__defineGetter__(c,f))}else A&&(50===u.length&&(q.push("Public ["+u.join("],[")+"]"),u.length=0),u[u.length]=a)},B);B&&!(B=0)&&0===K?u=q=w=0:A&&(K&&(x="StaticClass"+L+H++,q.unshift("Class "+x),q.push((u.length?"Public ["+u.join("],[")+"]\n":"")+"Private [(accessors)]","Private Sub Class_Initialize()",
"Set [(accessors)]="+x+"FactoryJS()","End Sub","End Class","Function "+x+"Factory()","Set "+x+"Factory=New "+x,"End Function"),i[x+"FactoryJS"]=function(){return q},i.execVBScript(q.join("\n")),K=u=q=p),q={},o.a=i[x+"Factory"](),C(g,function(a,b){if(w.hasOwnProperty(a))if(w[a]===1){v.prototype=g[a];q[a]=new v}else q[a]=w[a]!==3&&typeof b!=="function"?function(){return b}:g[a];else o.a[a]=(!J||k)&&typeof b==="function"&&a!=="__boon__"?function(){return b.apply(this===g||this==i?o.a:this,arguments)}:
b},1),g=o.a)}D.call(g,t)?o.i=g[t]:D.call(g,"constructor")&&(o.i=g.constructor);return new function(){!a&&"function"===typeof o.i&&o.i.apply(g,b);return g}}var l,k,r,A=H,B=1,a=arguments,b=a.length-1,t="constructor",x=p,q=[],u=[],K=0,w=H===p?0:{},y,m,O,z,J,M=this instanceof n,F=a[b--]||{};if(a[b]&&"object"===typeof a[b]&&!(a[b]instanceof I)&&a[b].constructor&&a[b].constructor!==s.prototype.constructor){if(H&&G)try{G(a[b],"t"+L,{configurable:1,set:function(a){A=a}}),a[b]["t"+L]=0,delete a[b]["t"+L]}catch(T){}y=
A?p:(z=P,a[b--])}f=!a[b]||a[b]instanceof I||"object"!==typeof a[b]?"boolean"===typeof a[b]||"number"===typeof a[b]?{compact:a[b--]}:{}:a[b--];z=z||f.compact;l=f.context;k=f.extend;r=f.mixins;O=f.statics||(l||k||r||"compact"in f?{}:f);j=a[b]instanceof I?a[b--]:"function"===typeof a[b]?[a[b--]]:"string"===typeof a[b-1]&&(""+a[b--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[];m="string"===typeof a[b]&&a[b--].split(/extends|implements|,/g)||
[];c=a[b--]||l||n.boonScope||(n.boonScope=i);d=(m.shift()||"").replace(/^\s+|\s+$/g,"");l=(m=m.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?m.split(","):[];k=(k=k||[])instanceof I?k:[k];r=(r=r||[])instanceof I?r:[r];j=l.concat.apply(l,j.concat.apply(j,k.concat.apply(k,r)));if(!(J=j.length)&&!(d||z!==E))z=P;if("function"!==typeof F)var S=F,F=function(){v.prototype=S.constructor.prototype;m=new v;C(S,function(a,b){m[a]=b});return m};h.toString=function(){return"[object "+(d||"Function")+
"]"};h.getInstanceOf=N;h.baseContext=c;C(O,function(a,b){h[a]=b});if(h.b=d){l=c;a=(m=d.split(".")).shift();do 0===m.length?l[t=a]=h:(a in l||(l[a]={}),l=l[a]);while(a=m.shift())}return M?new h:h}function M(c,d){var j=p,f=d,i,h;if("string"===typeof c){for(h=c.split(".");(i=h.shift())&&(d=d[i]););"function"===typeof d&&f===d.baseContext&&(j=d)}return j}function V(c,d){var j=M(c,d)||M(c,i)||"function"===typeof n.autoload&&n.autoload(c,d)||p;if(!j)throw Error("Parent constructor '"+c+"' not Initialized or Undefined");
return j}function C(c,d,j){var f,i=t.length,h;for(f in c)if(h=c[f],(j&&h!==s.prototype[f]||D.call(c,f))&&d.call(h,f,h)===y){i=y;break}if(i&&T)for(f=0;f<i&&!(h=c[t[f]],(D.call(c,t[f])||j&&t[f]in c&&h!==s.prototype[t[f]])&&d.call(h,t[f],h)===y);f++);}function N(c){for(;c&&c.__boon__!=p;){if(c.__boon__===this)return c;c=s.getPrototypeOf?s.getPrototypeOf(c):c.__proto__}return p}var I=i.Array,s=i.Object,R=i.Boolean,G=s.defineProperty,D=s.prototype.hasOwnProperty,W=!(s.getPrototypeOf||s.prototype.__proto__),
v=function(){return function(){}}(),L=(new Date).getTime(),T=!{toString:1}.propertyIsEnumerable("toString"),t="toString,toLocaleString,valueOf,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,constructor".split(",");n.instanceOf=function(c,d){return!!N.call(d,c)};var H=function(c){function d(d){c=d}try{G(c,"t",{set:d})}catch(j){try{c.__defineSetter__("t",d)}catch(f){}}c.t=0;c&&(c=1,"execVBscript"in i||("execScript"in i?i.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function",
"VBScript"):c=p));return c}({});n.boonScope=n.boonScope||i;i.boon=n})(window,!0,!1,null);
