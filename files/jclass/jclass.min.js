/*
 * jClass - class definition for JavaScript v1.4.0
 *
 * Copyright 2012-2014, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
 *
 * http://spb-piksel.ru/ - https://github.com/devote
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * Update: 03/20/2014
 */
(function(l,T,w,o,L){function O(g,b){return function(){throw Error("'"+g+"' property is "+(b?"read":"write")+"-only");}}function t(){}function H(g,b){var h=o,e=b,j,c;if("string"===typeof g){for(c=g.split(".");(j=c.shift())&&(b=b[j]););"function"===typeof b&&e===b.b&&(h=b)}return h}function U(g,b){var h=H(g,b)||H(g,l)||"function"===typeof jClass.autoload&&jClass.autoload(g,b)||o;if(!h)throw Error("Parent class '"+g+"' not Initialized or Undefined");return h}function A(g,b,h){var e,j=p.length,c;for(e in g)if(c=
g[e],(h&&c!==B.prototype[e]||D.call(g,e))&&b.call(c,e,c)===w){j=w;break}if(j&&P)for(e=0;e<j&&!(c=g[p[e]],(D.call(g,p[e])||h&&p[e]in g&&c!==B.prototype[p[e]])&&b.call(c,p[e],c)===w);e++);}function Q(g){for(;g&&g.__class__!=o;){if(g.__class__===this)return g;g=g.parent}return o}var E=l.Array,B=l.Object,R=l.Boolean,F=B.defineProperty,D=B.prototype.hasOwnProperty,I=(new Date).getTime(),P=!{toString:1}.propertyIsEnumerable("toString"),p="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" ");
l.jClass=function b(h,e,j,c,p){function r(){var a=J,b=this instanceof R,d=arguments,e=o,c=new p,k=b&&d[2]||o,f=M||k||c,m=b?d[0]:{a:c},i=!b||d[1]===L||C!==L?C:d[1];for(A(N,function(V,b){c[V]=b});a--;)"string"===typeof j[a]&&(j[a]=U(j[a],h)),t.prototype=e=j[a].call(new R,m,i,k),0<a&&(m.i=o),f=k=new t,i||(f.parent=e);if(J||b||M){var n=function(b){return"function"===typeof b?function(){var a=m.a,d=a.parent;!i&&(a.parent=e);var c=b.apply(this===f||this==l?a:this,arguments);!i&&(a.parent=d);return c}:b};
A(c,function(b,a){if(a&&"object"===typeof a&&("set"in a&&(a.set=n(a.set)),"get"in a))a.get=n(a.get);f[b]=n(a)});m.a=b?m.a:f}i||(f.__class__=r);if(!b&&0!==x){if(!y||z)A(z?f:x,function(a){var b=f[a],d=a,c=!z?x[a]:b&&"object"===typeof b&&"parent"!==a&&(b.set||b.get)?1:0===a.indexOf("get ")?2:0===a.indexOf("set ")?3:y&&"toString"===a?4:0;if(c)if(z&&4!==(x[a]=c)&&K++,1===c?(t.prototype=b,b=new t):d=a.split(" ").pop(),y)3!==c&&q.push("Public "+(4===c?"Default ":"")+"Property Get ["+d+"]","Call VBCorrectVal("+
(b&&(1!==c||b.get)?"[(accessors)].["+a+"]"+(1===c?".get":"")+".call(me,[(accessors)].["+a+"])":"window.undefined")+",["+d+"])","End Property"),2!==c&&q.push("Public Property Let ["+d+"](val)",c=(4===c?"Set [(accessors)].["+a+"]=val":b&&(1!==c||b.set)?"Call [(accessors)].["+a+"]"+(1===c?".set":"")+".call(me,val,[(accessors)].["+a+"])":"")+"\nEnd Property","Public Property Set ["+d+"](val)",c);else{var e=function(a){((c===1?b.set:b)||O(d,1)).call(this,a,b)},h=function(){return((c===1?b.get:b)||O(d,
0)).call(this,b)};D.call(f,a)&&delete f[a];F?(a=B.getOwnPropertyDescriptor(f,d),F(f,d,{enumerable:G?0:1,configurable:1,set:2===c&&a&&a.set||e,get:3===c&&a&&a.get||h})):(f.__defineSetter__(d,2===c&&f.__lookupSetter__(d)||e),f.__defineGetter__(d,3===c&&f.__lookupGetter__(d)||h))}else y&&(50===s.length&&(q.push("Public ["+s.join("],[")+"]"),s.length=0),s[s.length]=a)},z);z&&!(z=0)&&0===K?s=q=x=0:y&&(K&&(u="StaticClass"+I+G++,q.unshift("Class "+u),q.push((s.length?"Public ["+s.join("],[")+"]\n":"")+"Private [(accessors)]",
"Private Sub Class_Initialize()","Set [(accessors)]="+u+"FactoryJS()","End Sub","End Class","Function "+u+"Factory()","Set "+u+"Factory=New "+u,"End Function"),l[u+"FactoryJS"]=function(){return q},l.execVBScript(q.join("\n")),K=s=q=o),q={},m.a=l[u+"Factory"](),A(f,function(a,b){if(x.hasOwnProperty(a))if(x[a]===1){t.prototype=f[a];q[a]=new t}else q[a]=f[a];else m.a[a]=(!J||i)&&typeof b==="function"&&a!=="__class__"?function(){return b.apply(this===f||this==l?m.a:this,arguments)}:b},1),f=m.a)}D.call(f,
w)?m.i=f[w]:D.call(f,"constructor")&&(m.i=f.constructor);return new function(){!b&&"function"===typeof m.i&&m.i.apply(f,d);return f}}var k,n,v,y=G,z=1,a=arguments,d=a.length-1,w="constructor",u=o,q=[],s=[],K=0,x=G===o?0:{},M,i,N,C,J,H=this instanceof b,p=a[d--]||{};if(a[d]&&"object"===typeof a[d]&&!(a[d]instanceof E)&&a[d].constructor&&a[d].constructor!==B.prototype.constructor){if(G&&F)try{F(a[d],"t"+I,{configurable:1,set:function(a){y=a}}),a[d]["t"+I]=0,delete a[d]["t"+I]}catch(P){}M=y?o:(C=T,a[d--])}c=
!a[d]||a[d]instanceof E||"object"!==typeof a[d]?{}:a[d--];C=C||c.compact;k=c.context;n=c.extend;v=c.mixins;N=c.statics||(k||n||v||C!==L?{}:c);j=a[d]instanceof E?a[d--]:"function"===typeof a[d]?[a[d--]]:"string"===typeof a[d-1]&&(""+a[d--]).replace(/(^|\s)(extends|implements)(\s|$)/g,",").replace(/^[\s,]+|\s(?=\s)|[\s,]+$/g,"").replace(/\s*,\s*/g,",").split(",")||[];i="string"===typeof a[d]&&a[d--].split(/extends|implements|,/g)||[];h=a[d--]||k||b.classScope||(b.classScope=l);e=(i.shift()||"").replace(/^\s+|\s+$/g,
"");k=(i=i.join(",").replace(/^[\s,]+|[\s,]+$/g,"").replace(/\s*,\s*/g,","))?i.split(","):[];n=(n=n||[])instanceof E?n:[n];v=(v=v||[])instanceof E?v:[v];j=k.concat.apply(k,j.concat.apply(j,n.concat.apply(n,v)));J=j.length;if("function"!==typeof p)var S=p,p=function(){t.prototype=S.constructor.prototype;i=new t;A(S,function(a,b){i[a]=b});return i};r.toString=function(){return"[class "+(e||"Object")+"]"};r.getInstanceOf=Q;r.baseContext=h;A(N,function(a,b){r[a]=b});if(r.className=e){k=h;a=(i=e.split(".")).shift();
do 0===i.length?k[w=a]=r:(a in k||(k[a]={}),k=k[a]);while(a=i.shift())}return H?new r:r};jClass.instanceOf=function(b,h){return!!Q.call(h,b)};var G=function(b){function h(c){b=c}try{F(b,"t",{set:h})}catch(e){try{b.__defineSetter__("t",h)}catch(j){}}b.t=0;b&&(b=1,"execVBscript"in l||("execScript"in l?l.execScript("Function execVBscript(code) ExecuteGlobal(code) End Function\nFunction VBCorrectVal(o,r) If IsObject(o) Then Set r=o Else r=o End If End Function","VBScript"):b=o));return b}({});jClass.classScope=
jClass.classScope||l})(window,!0,!1,null);
